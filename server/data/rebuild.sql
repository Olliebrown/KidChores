DROP TABLE IF EXISTS Users;
CREATE TABLE Users (
	id INTEGER PRIMARY KEY AUTOINCREMENT,
	username TEXT NOT NULL,
	passwordhash BINARY NOT NULL,
  usertype TEXT DEFAULT child NOT NULL,  
  firstname TEXT,
  lastname TEXT,
  token BLOB,
  tokenissued INTEGER DEFAULT 0
);

DROP TABLE IF EXISTS Category;
CREATE TABLE Category (
	id INTEGER PRIMARY KEY AUTOINCREMENT,
	name TEXT NOT NULL,
	starthour INTEGER DEFAULT 0 NOT NULL
);

DROP TABLE IF EXISTS Tasks;
CREATE TABLE Tasks (
	id INTEGER PRIMARY KEY AUTOINCREMENT,
	name TEXT NOT NULL,
	categoryid INTEGER,
  value REAL DEFAULT 0.0 NOT NULL,
  details TEXT,
  CONSTRAINT Tasks_Category_FK FOREIGN KEY (categoryid) REFERENCES Category(id) ON DELETE SET NULL ON UPDATE CASCADE
);

DROP TABLE IF EXISTS CompletedTasks;
CREATE TABLE CompletedTasks (
	id INTEGER PRIMARY KEY AUTOINCREMENT,
	dayepoch INTEGER DEFAULT 0 NOT NULL,
	userid INTEGER,
	taskid INTEGER,
	approved INTEGER DEFAULT 0 NOT NULL,
	paid INTEGER DEFAULT 0 NOT NULL,
	CONSTRAINT CompletedTasks_Users_FK FOREIGN KEY (userid) REFERENCES Users(id) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT CompletedTasks_Tasks_FK FOREIGN KEY (taskid) REFERENCES Tasks(id) ON DELETE SET NULL ON UPDATE CASCADE
);
